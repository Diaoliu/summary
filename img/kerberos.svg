<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="693px" height="693px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36&quot; version=&quot;5.5.3.2&quot; editor=&quot;www.draw.io&quot; type=&quot;onedrive&quot;&gt;&lt;diagram&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><path d="M 651 100 L 651 595" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><rect x="646" y="495" width="10" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 456 105 L 456 475" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 66 258 L 449.63 258" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 454.88 258 L 447.88 261.5 L 449.63 258 L 447.88 254.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 46 95 L 46 58.83 C 46.04 57.83 46.88 57.04 47.93 57 L 63.65 57 C 64.66 57.08 65.46 57.86 65.49 58.83 L 65.49 69.03 L 57.15 69.03 C 55.93 69.31 54.99 70.23 54.74 71.39 L 54.74 85.71 L 48.89 85.71 L 48.89 87.54 L 54.74 87.54 C 54.73 88.17 54.81 88.8 54.99 89.36 L 48.89 89.36 L 48.89 91.27 L 63.17 91.19 C 61.41 91.37 60.11 93.04 60.28 94.92 Z M 48.89 64.42 L 62.61 64.42 L 62.61 62.56 L 48.89 62.56 Z M 56.71 72 C 56.73 71.4 57.24 70.92 57.87 70.9 L 84.75 70.9 C 85.07 70.9 85.37 71.02 85.6 71.23 C 85.83 71.45 85.95 71.74 85.95 72.04 L 85.95 88.07 C 86 88.4 85.89 88.73 85.66 88.98 C 85.43 89.23 85.1 89.37 84.75 89.36 L 73.28 89.36 L 73.28 91.38 C 73.49 91.92 73.89 92.37 74.4 92.68 C 75.58 92.66 76.76 92.71 77.93 92.83 C 78.72 92.86 79.49 93.11 80.14 93.55 C 80.36 93.76 80.45 94.13 80.34 94.46 C 80.24 94.78 79.97 94.98 79.69 94.92 L 76.93 94.92 L 73.96 94.09 L 68.22 94.09 L 65.9 94.92 L 62.69 94.92 C 62.42 94.82 62.24 94.58 62.21 94.31 C 62.27 93.83 62.61 93.42 63.09 93.25 C 63.75 92.97 64.45 92.8 65.17 92.75 L 68.14 92.68 C 68.86 92.32 69.34 91.65 69.43 90.89 L 69.43 89.36 L 57.87 89.36 C 57.54 89.35 57.23 89.2 57.01 88.95 C 56.8 88.7 56.7 88.39 56.75 88.07 Z M 59.64 73.64 L 59.64 86.59 L 83.06 86.59 L 83.06 73.64 Z" fill="#00188d" stroke="none" pointer-events="none"/><path d="M 246.03 95 L 246.03 58.98 C 246 57.96 246.78 57.09 247.82 57 L 263.21 57 C 264.18 57.16 264.89 58.01 264.85 58.98 L 264.85 79.18 L 256.38 79.18 L 256.38 85.71 L 248.87 85.71 L 248.87 87.65 L 256.38 87.65 L 256.38 89.41 L 248.87 89.41 L 248.87 91.3 L 256.38 91.3 L 256.38 95 Z M 248.82 64.39 L 262.01 64.39 L 262.01 62.5 L 248.82 62.55 Z M 257.77 80.64 L 279 80.64 L 279 94.53 L 257.77 94.53 Z M 258.91 84.68 L 258.91 93.37 L 263.67 93.37 L 263.67 84.68 Z M 264.89 93.37 L 277.82 93.37 L 277.82 84.68 L 264.89 84.68 Z M 268.39 92.21 L 268.39 91.09 L 274.81 91.09 L 274.81 92.18 Z M 274.81 90.44 L 268.39 90.44 L 268.39 89.33 L 274.81 89.33 Z M 268.39 88.72 L 268.39 87.56 L 274.81 87.56 L 274.81 88.72 Z M 274.81 87 L 268.39 87 L 268.39 85.84 L 274.81 85.84 Z" fill="#00188d" stroke="none" pointer-events="none"/><path d="M 380 122.6 C 380.22 121.28 381.66 120.04 384.05 119.09 C 389.52 117.02 397.92 117 403.43 119.05 C 406.04 119.98 407.66 121.24 408 122.6 L 408 149.22 C 407.75 150.67 406.03 152.02 403.21 152.99 C 397.5 155 389.24 154.81 384.05 152.55 C 381.76 151.65 380.33 150.47 380 149.22 Z M 403.58 123.34 C 404.14 122.79 404.14 122.19 403.58 121.64 C 402.38 120.36 398.46 119.48 394 119.48 C 389.54 119.48 385.62 120.36 384.42 121.64 C 383.86 122.19 383.86 122.79 384.42 123.34 C 385.62 124.62 389.54 125.5 394 125.5 C 398.46 125.5 402.38 124.62 403.58 123.34 Z" fill="#00188d" stroke="none" pointer-events="none"/><path d="M 66 295 L 66 295" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 262 215 L 262 225" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 66 135 L 249.63 135" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 254.88 135 L 247.88 138.5 L 249.63 135 L 247.88 131.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(113.5,127.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="103" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">uid, pass, nonce_1</div></div></foreignObject><text x="52" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">uid, pass, nonce_1</text></switch></g><g transform="translate(47.5,8.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="32" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Client</div></div></foreignObject><text x="16" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Client</text></switch></g><g transform="translate(247.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="83" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>Authentication</b><div><b>Server</b></div></div></div></foreignObject><text x="42" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(367.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="53" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Database</div></div></foreignObject><text x="27" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Database</text></switch></g><path d="M 274.12 135 L 369.63 135" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 267.12 135 L 274.12 132.67 L 274.12 137.33 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 374.88 135 L 367.88 138.5 L 369.63 135 L 367.88 131.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(297.5,120.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="49" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">check<div>uid, pass</div></div></div></foreignObject><text x="25" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 256 175 L 72.37 175" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 67.12 175 L 74.12 171.5 L 72.37 175 L 74.12 178.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(109.5,167.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="118" height="15" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">En<sub>pass</sub>(sid, nonce_1) </div></div></foreignObject><text x="59" y="14" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">En&lt;sub&gt;pass&lt;/sub&gt;(sid, nonce_1)&amp;nbsp;</text></switch></g><path d="M 256 215 L 72.37 215" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 67.12 215 L 74.12 211.5 L 72.37 215 L 74.12 218.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(125.5,209.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="85" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;"><div>TGT(encrypted)</div></div></div></foreignObject><text x="43" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&lt;div&gt;TGT(encrypted)&lt;/div&gt;</text></switch></g><path d="M 66 255 L 66 595" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><rect x="197" y="235" width="130" height="50" fill="#ffffff" stroke="none" pointer-events="none"/><g transform="translate(204.5,237.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="115" height="46" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>En</span><sub>TGS_key</sub><span>(TGT, sid) </span><br /><div><span>En</span><sub>sid</sub><span>(uid, timestamp)</span><br /></div><div>nonce_2</div></div></div></foreignObject><text x="58" y="29" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 446.03 95 L 446.03 58.98 C 446 57.96 446.78 57.09 447.82 57 L 463.21 57 C 464.18 57.16 464.89 58.01 464.85 58.98 L 464.85 79.18 L 456.38 79.18 L 456.38 85.71 L 448.87 85.71 L 448.87 87.65 L 456.38 87.65 L 456.38 89.41 L 448.87 89.41 L 448.87 91.3 L 456.38 91.3 L 456.38 95 Z M 448.82 64.39 L 462.01 64.39 L 462.01 62.5 L 448.82 62.55 Z M 457.77 80.64 L 479 80.64 L 479 94.53 L 457.77 94.53 Z M 458.91 84.68 L 458.91 93.37 L 463.67 93.37 L 463.67 84.68 Z M 464.89 93.37 L 477.82 93.37 L 477.82 84.68 L 464.89 84.68 Z M 468.39 92.21 L 468.39 91.09 L 474.81 91.09 L 474.81 92.18 Z M 474.81 90.44 L 468.39 90.44 L 468.39 89.33 L 474.81 89.33 Z M 468.39 88.72 L 468.39 87.56 L 474.81 87.56 L 474.81 88.72 Z M 474.81 87 L 468.39 87 L 468.39 85.84 L 474.81 85.84 Z" fill="#00188d" stroke="none" pointer-events="none"/><g transform="translate(447.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="87" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>Ticket Granting</b><div><b>Server</b></div><div><span>TGS_key</span><b><br /></b></div></div></div></foreignObject><text x="44" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="61" y="215" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 66 105 L 66 215" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(11.5,222.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="47" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: right;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">转发TGT<div>给TGS</div></div></div></foreignObject><text x="24" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="258" y="175" width="10" height="40" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 262 105 L 262 175" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(269.5,182.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="155" height="29" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><span>使用TGS_Key加密TGT和SID</span><div><span>En</span><sub>TGS_key</sub><span>(TGT, sid) </span><span><br /></span></div></div></div></foreignObject><text x="78" y="21" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="453" y="260" width="10" height="185" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(464.5,262.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="134" height="180" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">使用TGS_Key解密<div>得到TGT和SID</div><div>再使用SID解密</div><div>得到UID和时间戳</div><div><br /></div><div><div>校验时间戳</div><div>创建新的server_sid</div><div><br /></div><div><div>使用TGS_sid</div><div>加密server_sid和nonce2</div></div><div><br /></div><div>使用app serverd的密钥</div><div>加密SGT和TGS_sid</div></div></div></div></foreignObject><text x="67" y="96" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 456 445 L 72.37 445" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 67.12 445 L 74.12 441.5 L 72.37 445 L 74.12 448.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(182.5,428.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="177" height="32" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;"><div><span>En</span><span><sub>app_server_key</sub></span><span>(SGT, TGS_sid)</span><br /></div> En<sub>TGS_sid</sub>(server_sid, nonce_2)</div></div></foreignObject><text x="89" y="22" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 661.51 94.92 C 659.02 94.92 656.63 93.97 654.88 92.26 C 653.12 90.56 652.16 88.25 652.19 85.86 C 652.19 83.49 653.17 81.21 654.92 79.53 C 656.67 77.86 659.04 76.91 661.51 76.91 C 664 76.89 666.39 77.83 668.15 79.51 C 669.92 81.19 670.91 83.48 670.91 85.86 C 671 88.28 670.04 90.63 668.26 92.35 C 666.48 94.07 664.03 95 661.51 94.92 Z M 658.89 93.02 C 658.29 92.29 657.89 91.43 657.74 90.51 C 657.04 90.63 656.37 90.84 655.72 91.12 C 656.6 92 657.69 92.66 658.89 93.06 Z M 662.42 93.1 C 663.12 92.25 663.62 91.28 663.89 90.24 C 662.35 90.03 660.79 90.05 659.25 90.28 C 659.46 91.34 659.99 92.31 660.76 93.1 C 660.97 93.34 661.27 93.48 661.59 93.48 C 661.91 93.48 662.21 93.34 662.42 93.1 Z M 658.89 88.98 C 660.65 88.66 662.45 88.66 664.21 88.98 C 664.37 88.21 664.45 87.42 664.45 86.62 L 658.65 86.62 C 658.63 87.42 658.71 88.21 658.89 88.98 Z M 653.66 86.62 C 653.75 87.81 654.13 88.96 654.77 89.97 C 655.63 89.58 656.56 89.31 657.5 89.17 C 657.29 88.34 657.2 87.48 657.23 86.62 Z M 657.23 85.18 C 657.19 84.24 657.3 83.3 657.54 82.4 C 656.67 82.25 655.81 82 655 81.64 C 654.22 82.68 653.73 83.9 653.58 85.18 Z M 664.41 85.18 C 664.44 84.33 664.36 83.49 664.17 82.66 C 662.42 82.95 660.64 82.95 658.89 82.66 C 658.7 83.49 658.62 84.33 658.65 85.18 Z M 660.8 78.63 C 660.02 79.38 659.5 80.33 659.29 81.37 C 660.79 81.61 662.31 81.61 663.81 81.37 C 663.53 80.36 663.02 79.42 662.3 78.63 C 661.88 78.22 661.22 78.22 660.8 78.63 Z M 657.86 81.1 C 658.08 80.28 658.41 79.48 658.85 78.74 C 657.77 79.17 656.78 79.77 655.92 80.53 C 656.54 80.79 657.19 80.98 657.86 81.1 Z Z Z Z Z M 667.06 80.53 C 666.25 79.8 665.31 79.21 664.29 78.78 C 664.71 79.51 665.03 80.29 665.24 81.1 C 665.87 80.97 666.48 80.78 667.06 80.53 Z M 669.44 85.18 C 669.28 83.92 668.8 82.72 668.06 81.67 C 667.26 82.03 666.42 82.29 665.56 82.43 C 665.77 83.35 665.86 84.28 665.83 85.21 Z M 665.28 90.51 C 665.06 91.42 664.7 92.29 664.21 93.1 C 665.42 92.69 666.51 92.01 667.38 91.12 C 666.71 90.82 666.01 90.62 665.28 90.51 Z M 665.83 86.66 C 665.85 87.5 665.77 88.35 665.6 89.17 C 666.51 89.34 667.4 89.61 668.25 89.97 C 668.91 88.96 669.31 87.81 669.44 86.62 Z M 641 94.62 L 641 58.83 C 641.04 57.85 641.85 57.06 642.86 57 L 658.14 57 C 659.2 57 660.08 57.81 660.12 58.83 L 660.12 75.47 C 654.86 76.17 650.85 80.35 650.56 85.44 L 643.86 85.44 L 643.86 87.31 L 650.64 87.31 C 650.72 87.93 650.87 88.54 651.08 89.14 L 643.86 89.14 L 643.86 90.96 L 651.87 90.96 C 652.68 92.46 653.88 93.72 655.36 94.62 Z M 643.96 64.3 L 657.29 64.35 L 657.25 62.59 L 643.96 62.49 Z" fill="#00188d" stroke="none" pointer-events="none"/><g transform="translate(642.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">App<div>Server</div></div></div></foreignObject><text x="18" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 651 575 L 651 575" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 71 495 L 644.63 495" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 649.88 495 L 642.88 498.5 L 644.63 495 L 642.88 491.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(291.5,489.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="138" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;"> forwarding to app server </div></div></foreignObject><text x="69" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">&amp;nbsp;forwarding to app server&amp;nbsp;</text></switch></g><g transform="translate(480.5,507.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="160" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: right;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">使用app_server_key解密内容<div>检验SGT<div>获取server_sid</div><div>提供服务</div></div></div></div></foreignObject><text x="80" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 652 575 L 73.37 575" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 68.12 575 L 75.12 571.5 L 73.37 575 L 75.12 578.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(342.5,569.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;"> service </div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(67.5,622.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="293" height="68" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">uid = user id<div>sid = session ID  between AS and TGS</div><div>server_sid = session id between client and App server</div><div>TGS_sid = session id between TGS and App server  </div><div>TGS_key = key on <span>Ticket Granting </span><span style="line-height: 1.2">Server</span></div></div></div></foreignObject><text x="147" y="40" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 291 76 L 431 76" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(353.5,70.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="16" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">sid</div></div></foreignObject><text x="8" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">sid</text></switch></g><path d="M 494 76 L 634 76" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(540.5,70.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="47" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;background-color:#ffffff;">TGS_sid</div></div></foreignObject><text x="24" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">TGS_sid</text></switch></g></g></svg>