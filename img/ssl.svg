<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="694px" height="666px" version="1.1" content="&lt;mxfile userAgent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.106 Safari/537.36&quot; version=&quot;5.5.5.2&quot; editor=&quot;www.draw.io&quot; type=&quot;onedrive&quot;&gt;&lt;diagram&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g transform="translate(0.5,0.5)"><rect x="1" y="21" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 41 51 L 41 301" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(23.5,30.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="35" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 36px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Client</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Client</text></switch></g><rect x="36" y="80" width="10" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="161" y="21" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 201 51 L 201 301" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(181.5,30.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="39" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Server</div></div></foreignObject><text x="20" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Server</text></switch></g><rect x="196" y="140" width="10" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 41 140 L 192.38 140" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.38 140 L 192.38 143.5 L 192.38 136.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(67.5,143.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="107" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>client_hello</b><div>version<div>client_random</div><div>support cipher suite</div></div></div></div></foreignObject><text x="54" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 193 221 L 42.74 221" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 50.62 216.5 L 41.62 221 L 50.62 225.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 561 261 L 402.74 261" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 410.62 256.5 L 401.62 261 L 410.62 265.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(431.5,246.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="97" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>server_hello_done</b></div></div></foreignObject><text x="49" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">&lt;b&gt;server_hello_done&lt;/b&gt;</text></switch></g><g transform="translate(52.5,93.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="82" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">generate<div><span><b>client_random</b></span></div></div></div></foreignObject><text x="41" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(212.5,172.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="89" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">generate<div><b>server_random</b></div></div></div></foreignObject><text x="45" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><g transform="translate(82.5,227.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="73" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>server_hello</b><div>same content</div></div></div></foreignObject><text x="37" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><rect x="361" y="21" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 401 51 L 401 301" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(383.5,30.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="35" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 36px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Client</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Client</text></switch></g><rect x="521" y="21" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 561 51 L 561 301" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(541.5,30.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="39" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Server</div></div></foreignObject><text x="20" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Server</text></switch></g><path d="M 561 101 L 402.74 101" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 410.62 96.5 L 401.62 101 L 410.62 105.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(433.5,86.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="93" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>certificate CA证书</b></div></div></foreignObject><text x="47" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">&lt;b&gt;certificate CA证书&lt;/b&gt;</text></switch></g><g transform="translate(565.5,184.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="126" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">可选项<div>如果需要客户端</div><div>提供Diffie-Hellman公钥</div><div>或者CA证书</div></div></div></foreignObject><text x="63" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 561 141 L 402.74 141" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 410.62 136.5 L 401.62 141 L 410.62 145.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(419.5,126.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="122" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">[ server_key_exchange ]</div></div></foreignObject><text x="61" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[ server_key_exchange ]</text></switch></g><g transform="translate(564.5,94.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="125" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">二选一<div>如果服务器没有CA证书</div><div>将会使用临时公钥</div><div>或者Diffie-Hellman</div></div></div></foreignObject><text x="63" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 561 211 L 402.74 211" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 410.62 206.5 L 401.62 211 L 410.62 215.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(430.5,196.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="99" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">[ certificate request ]</div></div></foreignObject><text x="50" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[ certificate request ]</text></switch></g><g transform="translate(98.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Phase 1</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Phase 1</text></switch></g><g transform="translate(458.5,3.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Phase 2</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Phase 2</text></switch></g><rect x="1" y="341" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 41 371 L 41 621" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(23.5,350.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="35" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 36px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Client</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Client</text></switch></g><rect x="36" y="382" width="10" height="80" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="161" y="341" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 201 371 L 201 621" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(181.5,350.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="39" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Server</div></div></foreignObject><text x="20" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Server</text></switch></g><g transform="translate(98.5,323.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Phase 3</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Phase 3</text></switch></g><path d="M 192.88 462 L 40.5 462" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 199.88 462 L 192.88 464.33 L 192.88 459.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(70.5,447.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="99" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">[ certificate CA证书 ]</div></div></foreignObject><text x="50" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">[ certificate CA证书 ]</text></switch></g><g transform="translate(207.5,448.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="144" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">可选项<div>如果服务器端要求提供证书</div></div></div></foreignObject><text x="72" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">可选项&lt;div&gt;如果服务器端要求提供证书&lt;/div&gt;</text></switch></g><path d="M 192.88 535 L 40.5 535" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 199.88 535 L 192.88 537.33 L 192.88 532.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(65.5,520.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="110" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;"><b>client_key_exchange</b></div></div></foreignObject><text x="55" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">&lt;b&gt;client_key_exchange&lt;/b&gt;</text></switch></g><g transform="translate(207.5,523.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="140" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">发送使用服务器端公钥<div>加密的Premaster_serect<div>或者发送Diff-Hellman公钥</div></div></div></div></foreignObject><text x="70" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 193.88 596 L 41.5 596" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 200.88 596 L 193.88 598.33 L 193.88 593.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(81.5,581.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="79" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">certificate verifiy</div></div></foreignObject><text x="40" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">certificate verifiy</text></switch></g><rect x="361" y="341" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 401 371 L 401 621" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(383.5,350.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="35" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 36px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Client</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Client</text></switch></g><rect x="396" y="541" width="10" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><rect x="521" y="341" width="80" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><path d="M 561 371 L 561 621" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><g transform="translate(541.5,350.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="39" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 40px; white-space: nowrap; word-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">:Server</div></div></foreignObject><text x="20" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">:Server</text></switch></g><rect x="556" y="541" width="10" height="60" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(458.5,323.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="45" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">Phase 4</div></div></foreignObject><text x="23" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">Phase 4</text></switch></g><g transform="translate(52.5,386.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="104" height="54" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">verify certificate<div><span style="line-height: 1.2">generate </span></div><div><span style="line-height: 1.2"><b>premaster_secret</b></span><div><div><div><br /></div></div></div></div></div></div></foreignObject><text x="52" y="33" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 553.88 422 L 401.5 422" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 560.88 422 L 553.88 424.33 L 553.88 419.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(430.5,407.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">change_cipher_spec</div></div></foreignObject><text x="51" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">change_cipher_spec</text></switch></g><path d="M 552.88 462 L 400.5 462" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 559.88 462 L 552.88 464.33 L 552.88 459.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(461.5,447.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="37" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">finished</div></div></foreignObject><text x="19" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">finished</text></switch></g><path d="M 561 501 L 410.62 501" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 401.62 501 L 410.62 498 L 410.62 504 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(429.5,486.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="102" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">change_cipher_spec</div></div></foreignObject><text x="51" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">change_cipher_spec</text></switch></g><path d="M 560 541 L 409.62 541" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 400.62 541 L 409.62 538 L 409.62 544 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(460.5,526.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="37" height="11" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 11px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">finished</div></div></foreignObject><text x="19" y="11" fill="#000000" text-anchor="middle" font-size="11px" font-family="Helvetica">finished</text></switch></g><g transform="translate(446.5,558.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="69" height="26" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">generate<div><b>session key</b></div></div></div></foreignObject><text x="35" y="19" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica">[Not supported by viewer]</text></switch></g><path d="M 383.63 115.61 C 381.36 113.94 380.41 110.98 381.28 108.28 C 382.14 105.57 384.63 103.74 387.43 103.74 C 390.23 103.74 392.71 105.57 393.58 108.28 C 394.44 110.98 393.49 113.94 391.23 115.61 L 396 122.75 L 392.24 121.8 L 390.14 124.77 L 387.39 117.03 L 385.21 125 L 383.11 122.67 L 379.65 123.24 Z M 387.58 115.54 C 390.23 115.39 392.36 113.26 392.54 110.58 C 392.67 107.66 390.46 105.17 387.58 105.01 C 386.1 104.94 384.67 105.51 383.63 106.57 C 382.58 107.63 382.03 109.08 382.09 110.58 C 382.29 113.47 384.73 115.67 387.58 115.54 Z M 387.58 114.39 C 386.52 114.47 385.48 114.1 384.68 113.38 C 383.89 112.67 383.42 111.66 383.37 110.58 C 383.3 109.43 383.72 108.31 384.53 107.49 C 385.34 106.68 386.45 106.26 387.58 106.34 C 389.75 106.49 391.39 108.38 391.26 110.58 C 391.17 112.62 389.59 114.26 387.58 114.39 Z M 387.58 113.52 C 389.1 113.36 390.3 112.13 390.44 110.58 C 390.5 108.87 389.25 107.4 387.58 107.22 C 385.85 107.13 384.37 108.45 384.23 110.2 C 384.21 111.1 384.56 111.97 385.19 112.6 C 385.83 113.23 386.69 113.56 387.58 113.52 Z M 379.76 120.38 L 366 120.38 L 366 87 L 393.59 87 L 393.59 105.69 C 393.19 105.11 392.71 104.58 392.17 104.13 L 392.17 88.41 L 367.35 88.41 L 367.35 118.93 L 380.44 118.93 Z M 372.69 101.35 L 372.69 99.7 L 386.79 99.7 L 386.79 101.35 Z M 372.69 97.53 L 372.69 95.97 L 386.79 95.97 L 386.79 97.53 Z M 372.69 93.75 L 372.69 92.19 L 386.79 92.19 L 386.79 93.75 Z" fill="#505050" stroke="none" pointer-events="none"/><g transform="translate(76.5,646.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="448" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; white-space: nowrap; font-weight: bold; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;">session_key = encrypt ( client_random + server_random + premaster_serect )</div></div></foreignObject><text x="224" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Helvetica" font-weight="bold">session_key = encrypt ( client_random + server_random + premaster_serect )</text></switch></g></g></svg>